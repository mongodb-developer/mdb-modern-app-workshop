# ðŸ“˜ Implementing Vector Search

There are two components that you will need to do to implement vector search into your application.


## Setup OPEN AI key
You will need to set up your OpenAI key to use the encoder. You can do this by setting the `OPENAI_API_KEY` environment variable.

If no key provided for you by the workshop, you can get your key from the OpenAI website:
1. Go to the [OpenAI website](https://platform.openai.com/)
2. Sign up for an account
3. Create a new API key > Copy the key

You can set the key in your terminal.

## Install the openai library
You will need to install the openai library to use the encoder. You can do this by running the following command:

```bash
npm install openai
```


## Vectorize your dataset

First, you will need to create this mathematical representation of your data. This is called vectorization. In the Create Vectors section, you will learn how to create vectors with some of the major encoders.

We will use OpenAI's encoder to create vectors for our data. The encoder will convert the data into vectors. You can then store these vectors in your database.

Lets add a new function to vectorize the events documents on `backend/server.js`:
  ```javascript
  // backend/server.js
  const { OpenAI } = require("openai");

  const openai = new OpenAI();

  async function embedDocument(document) {
    
  const response = await openai.embeddings.create({
     model : 'text-embedding-3-small',
      input :JSON.stringify({
        'name' :  document['name'],
        'description' : document['description']
      })
  })

  document['embedding'] = response.data[0].embedding;
  return document;
}

async function embedMissingDocuments() {
  const events = await db.collection('events').find({ embedding: { $exists: false } }).toArray();
  for (let event of events) {
      event = await embedDocument(event);
      await db.collection('events').updateOne({ _id: event._id }, { $set: { embedding: event.embedding } });
  }
}

async function connect()
{
    db = await connectToMongoDB();
   // ...  rest of the code
    await embedMissingDocuments();
}
  ```
Those functions will embed the documents in the database using the OpenAI encoder. The `embedDocument` function will embed a single document, while the `embedMissingDocuments` function will embed all the documents in the database that do not have an embedding.

You can call the `embedMissingDocuments` function in the `connect` function to embed all the missing documents when the server starts.

